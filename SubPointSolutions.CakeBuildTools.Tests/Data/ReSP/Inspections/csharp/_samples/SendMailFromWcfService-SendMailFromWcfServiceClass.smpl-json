{"IsMethod":false,"IsClass":true,"Tags":[],"Scope":null,"Title":"","Description":"","MethodBodyWithFunction":"    \r\n    public class SendMailFromWcfService\r\n    {\r\n        [TestMethod]\r\n        public void CorrectSendMailFromWcfServiceUsage(SPWeb web, string to, string subject, string body)\r\n        {\r\n            // save current context\r\n            HttpContext curCtx = HttpContext.Current;\r\n            HttpContext.Current = null; // <-- recommended approach for wcf services\r\n\r\n            bool success = SPUtility.SendEmail(web, true, true, to, subject, body);\r\n\r\n            // restore the context\r\n            HttpContext.Current = curCtx;\r\n        }\r\n    }","MethodBody":"public class SendMailFromWcfService\r\n{\r\n    [TestMethod]\r\n    public void CorrectSendMailFromWcfServiceUsage(SPWeb web, string to, string subject, string body)\r\n    {\r\n        // save current context\r\n        HttpContext curCtx = HttpContext.Current;\r\n        HttpContext.Current = null; // <-- recommended approach for wcf services\r\n\r\n        bool success = SPUtility.SendEmail(web, true, true, to, subject, body);\r\n\r\n        // restore the context\r\n        HttpContext.Current = curCtx;\r\n    }\r\n}\r\n","Language":"cs","Namespace":"ReSharePoint.Docs.Basic.Inspection.Code","ClassName":"SendMailFromWcfService","MethodName":"SendMailFromWcfServiceClass","ClassComment":"","MethodFullName":"ClassSendMailFromWcfServiceClass","ClassFullName":"ReSharePoint.Docs.Basic.Inspection.Code.SendMailFromWcfService","MethodParametersCount":0,"SourceFileName":"SendMailFromWcfService.cs","SourceFileNameWithoutExtension":"SendMailFromWcfService"}